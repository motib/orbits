% !TeX root = orbits.tex
% !TeX Program=pdfLaTeX

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Properties of ellipses}\label{s.ellipse}

\section{Geometric properties of an ellipse}

%%Consider a circle of radius $a$ with the same center as an ellipse (Figure~\ref{f.ellipse-latus-rectum}). Choose a point $X$ on the major axis and construct a perpendicular through $X=(x,0)$. Let its intersections with the ellipse and the circle be $P_e=(x,y_e)$ and $P_c=(x,y_c)$, respectively.
\begin{theorem}\label{thm.ellipse-b-over-a}
The perpendicular to the major axis through a point $P_c=(x,y_c)$ on the circle circumscribing an ellipse intersects the ellipse at $P_e=(x,y_e)=\left(x,\displaystyle\frac{b}{a}y_c\right)$.
\end{theorem}
\begin{proof} From Equation~\ref{eqn.ellipse-formula} and the formula $x^2+y^2=a^2$ for the circle,
\begin{equation}
y_e= \frac{b}{a} \,\sqrt{(a^2-x^2)}=\frac{b}{a}y_c\,.\label{eq.ye}\fqed
\end{equation}
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[b]
\begin{center}
\begin{tikzpicture}[scale=.9]
\clip (-4.2,-3.5) rectangle +(8.4,7.2);

\def\a{3.2}
\def\b{2}
\pic{ellipse={{\a}/{\b}}};

\draw[name path=circle] circle[radius={\a}];
\node[below] at (F1) {$S$};
\node[below right] at (F2) {$H$};
\node[above] at (Top) {$B$};
\node[below] at (Bot) {$B'$};
\node[right] at (Right) {$A'$};
\node[left] at (Left) {$A$};

% Draw axes through O
\draw (F1) -- (O) -- node[below] {$c$} (F2);
\draw[name path=minor] (O) -- node[right] {$b$} (Top);

\coordinate (X) at (-1,0);
\path[name path=atX] (X) -- ($(X)+(0,4.5)$);
\path [name intersections = {of = atX and ellipse, by = {E1} }];
\path [name intersections = {of = atX and circle, by = {C1} }];
\draw (X) -- (C1);

% Label X and the intersections
\node[below] at (X) {$X$};
\node[above] at (C1) {$P_c$};
\node[above left,xshift=2pt,yshift=-2pt] at (E1) {$P_e$};

\draw (O) rectangle +(6pt,6pt);
\draw (X) rectangle +(6pt,6pt);

% Draw latus rectum as intersections of perpendicular at H
%  with the ellipse
\path[name path=LR] ($(F2)+(0,-2.5)$) -- ($(F2)+(0,2.5)$);
\path [name intersections = {of = ellipse and LR, by = {LR1,LR2} }];
\path [name intersections = {of = circle and LR, by = {LR1c,LR2c} }];
\draw[very thick,red] (LR1) -- (LR2);

% Label endpoint of the LR
\node[above] at (LR1) {$L_1$};
\node[below] at (LR2) {$L_2$};
\draw (F2) rectangle +(6pt,6pt);
\draw (F1) -- node[near start,above] {$a$} (Top) -- node[above] {$a$} (F2);

% Length of LR
\draw[<->,dashed,thick] ($(LR1)+(-.3,0)$) --
  node[left,xshift=2pt,yshift=-8pt] {$L$} ($(LR2)+(-.3,0)$);

\end{tikzpicture}
\caption{The circumscribed circle and the latus rectum of an ellipse}\label{f.ellipse-latus-rectum}
\end{center}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{theorem}\label{thm.ellipse-lr}
$L$, the length of the latus rectum of an ellipse, is 
$\displaystyle\frac{2b^2}{a}$.
\end{theorem}
\begin{proof}
The latus rectum is the perpendicular at the focus $(c,0)$. By Equation~\ref{eq.ye} and Pythagoras's theorem,
\begin{equation}\label{eqn.lr}
L=2L_1=2\cdot\frac{b}{a}\sqrt{a^2-c^2}=\displaystyle\frac{2b^2}{a}\,.\fqed
\end{equation}
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{theorem}\label{thm.ellipse-area}
The area of an ellipse is $\pi a b$.
\end{theorem}
\begin{proof}
From Equation~\ref{eq.ye}
\begin{eqn}
y_e &=& \frac{b}{a}\sqrt{a^2-x^2}\\
A_{\mathit{ellipse}} &=& 2\int_{-a}^{a}\frac{b}{a}\sqrt{a^2-x^2}\; dx = \frac{b}{a}\cdot 2\int_{-a}^{a}\sqrt{a^2-x^2}\; dx= \frac{b}{a}A_{\mathit{circle}}=\pi a b\,.\fqed
\end{eqn}%
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{The angles between a tangent and the lines to the foci}

\begin{theorem}\label{thm.tangent-angles}
Let $P$ be a point on the ellipse whose foci are $S,H$. Let $PU$ be the extension of $SP$ such that $SU=AA'=2a$. Then the tangent $RQ$ is the external angle bisector of $\angle HPU$ and $\angle RPS = \angle QPH$ (Figure~\ref{f.tangent-angles}).
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[t]
\begin{center}
\begin{tikzpicture}

% Size and center of the ellipse
\clip (-5,-.7) rectangle +(11.5,5.5);

\def\a{4.5}
\def\b{3.5}

\def\angle{50}

\pic{semi-ellipse={\a}/{\b}};
\pic{point-on-ellipse={\a}/{\b}/{\angle}};
\pic{tangent={0.7*\a}/{0.7*\b}/{\angle}};

\node[above right,white,fill] at (P) {$P$};
\node[above,yshift=3pt] at (P) {$P$};

\node[below] at (Right) {$A'$};
\node[below] at (Left) {$A$};
\node[below] at (O) {$O$};
\node[below] at (F1) {$S$};
\node[below] at (F2) {$H$};

\draw (F2) -- (P) -- (F1);

% Locate another point Q on the tangent
\coordinate (Q) at ($(P)!.9!(Z)$);
\node[right,xshift=2pt,yshift=2pt] at (Q) {$Q$};
\node[right,xshift=3pt] at (R) {$R$};

% Extend line SP to U
\draw[name path=fromF1p] (F1) -- ($(F1)!1.4!(P)$) coordinate (U);
\node[right] at (U) {$U$};

% Draw HQ and QU
\draw (F2) -- 
  node[below right,xshift=0pt,yshift=6pt] {$d$} (Q) -- 
  node[right] {$d$} (U);
\draw[name path=F2U] (F2) -- (U);
\draw (F1) -- (Q);

% Draw dashed line to local W
\path [name intersections = {of = t and F2U, by = {W} }];
\node[right,xshift=1pt,yshift=2pt] at (W) {$W$};

% Label angles
\node[below right,xshift=-1pt,yshift=-4pt] at (P) {$\alpha$};
\node[right,xshift=5pt,yshift=-1pt] at (P) {$\alpha$};
\node[left,xshift=-8pt,yshift=4pt] at (P) {$\alpha$};

% Indicate lengths of SU
\draw [<-,thick,dashed] ($(F1)+(0,3pt)$) --
   node[above,near end] {$2a$} ($(P)+(0pt,3pt)$);
\draw [->,thick,dashed] ($(P)+(0pt,3pt)$) --($(U)+(0,3pt)$);
\draw[rotate=57] (W) rectangle +(6pt,6pt);
\end{tikzpicture}
\caption{Angles at the tangent}\label{f.tangent-angles}
\end{center}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{proof}
We prove that the external angle bisector must be the tangent by showing that any point $Q\neq P$ on the bisector is not on the ellipse, so the bisector $RQ$ has only one point of intersection with the ellipse and it must be the tangent at $P$. $\angle QPH =\angle QPU=\angle RPS=\alpha$ since $RQ$ is the bisector and by vertical angles.

Construct the line $HU$ to form the triangle $\triangle HPU$ which intersects $PQ$ at $W$. By construction $PH=PU$ so $\triangle HPW\cong \triangle UPW$ by side-angle-side. Therefore, $\angle HWP=\angle UWP$ and they are right angles, so $\triangle HWQ=\triangle UWQ$ by side-angle-side and $UQ=HQ$. If $Q$ is on the ellipse, $2a=SQ+QH=SQ+QU$, but by the triangle inequality $2a=SQ+QU>SU=2a$, contradicting that $Q$ is on the ellipse.\hqed
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Conjugate diameters}

\begin{theorem}\label{thm.ratios}
Let $P=(x,y)$ be a point on an ellipse (not on the major axis $AA'$) and construct a perpendicular $PV$ from $P$ to the major axis (Figure~\ref{f.ellipse-ratios}). Then
\[
\frac{A'V\cdot AV}{PV^2} = \frac{a^2}{b^2}\,.
\]
\end{theorem}

\begin{proof}
By Equation~\ref{eq.ye},
\begin{eqn}
y^2&=&b^2\cdot \left(1-\frac{x^2}{a^2}\right)=\frac{b^2(a^2-x^2)}{a^2}\\
\frac{A'V\cdot AV}{PV^2}&=&\frac{(a+x)(a-x)}{y^2}=\frac{a^2(a^2-x^2)}{b^2(a^2-x^2)}= \frac{a^2}{b^2}\,.\fqed
\end{eqn}%
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[t]
\begin{minipage}{.48\textwidth}
\begin{center}
\begin{tikzpicture}
\clip (-3.4,-2.5) rectangle +(6.8,5.4);
% Size and center of the ellipse
\def\a{3}
\def\b{2}
\coordinate (O) at (0,0);
\node[below] at (O) {$O$};

% Draw an ellipse with center C
\draw[name path=ellipse] (\a,0) 
  arc[start angle=0,end angle=180, x radius=\a,y radius=\b];

% Locate the foci
\coordinate (F1) at ({-sqrt(\a*\a-\b*\b)},0);
\coordinate (F2) at ({+sqrt(\a*\a-\b*\b)},0);

% Draw axes whose center is C
\coordinate (L) at +(180:{\a} and {\b});
\coordinate (R) at +(0:{\a} and {\b});
\node[below] at (R) {$A'$};
\node[below] at (L) {$A$};
\coordinate (Top) at +(90:{\a} and {\b});
\draw[name path=major] (L) -- (R);
\draw[name path=minor] (O) -- (Top);

% Select an arbitrary point P on the ellipse and draw lines to the major axes
\path[name path=fromF1p] (F1) -- +(30:6);
\path [name intersections = {of = ellipse and fromF1p, by = {P} }];
\node[above right,yshift=-4pt] at (P) {$P=(x,y)$};
\path[name path=pv] (P) -- +(0,-\b);
\path [name intersections = {of = major and pv, by = {V} }];
\draw (P) -- node[left] {$y$} (V) node[below] {$V$};

% Draw length arrows
\draw[<->] ($(L)+(0,-24pt)$) -- 
  node[fill=white] {$a\!+\!x$} ($(V)+(0,-24pt)$);
\draw[<->] ($(V)+(0,-24pt)$) -- 
  node[fill=white] {$a\!-\!x$} ($(R)+(0,-24pt)$);
\end{tikzpicture}
\caption{Ratios on conjugate diameters}\label{f.ellipse-ratios}
\end{center}
\end{minipage}
\hspace*{6pt}
\begin{minipage}{.48\textwidth}
\begin{center}
\begin{tikzpicture}

\clip (-3.5,-2.5) rectangle +(7,5.4);

% Size and center of the ellipse
\def\a{3}
\def\b{2}
\def\angle{24}

\pic{ellipse={\a}/{\b}};
\node[below left,xshift=2pt,yshift=-3pt] at (O) {$O$};
\begin{scope}[rotate=24]
\draw[name path=ellipse1,thick,dashed] (O) 
  ellipse[x radius={\a},y radius= {\b}];
\path ({-\a},0) coordinate (G) node[left] {$G$} -- 
  ({\a},0) coordinate (P) node[right] {$P$};
\draw (0,{-\b}) coordinate (K) node[below,yshift=-2pt] {$K$} -- 
  (0,{\b}) coordinate (D) node[above] {$D$};

% Select an arbitrary point Q on the ellipse and draw a line to the Sun
\path [name path=oq] (O) -- +(40:7);
\path [name intersections = {of = ellipse1 and oq, by = {Q} }];
\node[above] at (Q) {$Q$};

\draw (O) rectangle +(6pt,6pt);

% Draw QV
\draw[green!80!black,thick] (Q) -- 
  ($(G)!(Q)!(P)$) coordinate (V) node[black,below] {$V$};
\draw[red,thick] (G) -- (V);
\draw[blue,thick] (V) -- (P);

\vertexsm{G};
\vertexsm{P};
\vertexsm{D};
\vertexsm{Q};
\vertexsm{K};

\end{scope}
\end{tikzpicture}
\caption{Rotating the ellipse}\label{f.conj-ratios}
\end{center}
\end{minipage}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{theorem}\label{thm.conj-diag}
Let $PG,DK$ be conjugate diameters of an ellipse and let $Q$ be a point on the ellipse (Figure~\ref{f.conj-ratios}). Constrct the perpendicular $QV$ from $Q$ to the major axis, then
\[
PV = \frac{QV^2\cdot OP^2}{GV \cdot OD^2}\,.
\]
\end{theorem}

\begin{proof}
Figure~\ref{f.conj-ratios} shows a dashed ellipse which is the original ellipse rotated about the same center $O$, so that $OP$ is the semi-major axis and $OD$ is the semi-minor axis. By Theorem~\ref{thm.ratios},
\begin{eqn}
\frac{GV\cdot PV}{QV^2}&=&\frac{a^2}{b^2}= \frac{OP^2}{OD^2}\\
PV &=& \frac{QV^2\cdot OP^2}{GV \cdot OD^2}\,.\fqed
\end{eqn}%
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55

\section{Areas of parallelograms}

\begin{theorem}\label{thm.conj-diam-para}
Let $PG, DK$ be conjugate diameters of an ellipse. The tangents to the ellipse at $P,G,D,K$ form a parallelogram $JKLM$ whose area is equal to the parallelogram (dashed rectangle) formed by the tangents to $A,A',B,B'$ (Figure~\ref{f.ellipse-conj-diam-proof}).
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[t]
\begin{center}
\begin{tikzpicture}
\clip (-5,-3.3) rectangle +(10,6.6);

% Size and center of the ellipse
\def\a{3}
\def\b{2}
\def\angle{35}

\pic{ellipse={\a}/{\b}};
\pic{point-on-ellipse={\a}/{\b}/{\angle}};
\pic{tangent={\a}/{\b}/{\angle}};

% Conjugate diameter from P through C
\draw[name path=pc] (P) -- ($(P)!2!(O)$) coordinate (G)
  node[below left,xshift=2pt,yshift=2pt] {$G$};

\node[above,yshift=-1pt] at (Top) {$B$};
\node[below,yshift=1pt] at (Bot) {$B'$};
\node[right,xshift=-1pt] at (Right) {$A'$};
\node[left,xshift=1pt] at (Left) {$A$};
\node[below left,xshift=2pt,yshift=-2pt] at (O) {$O$};

% Conjugate diameters from D through C
\path[name path=cd] (O) -- +({\angle+90}:{1.5*\a} and {1.5*\b});
\path[name path=dk] (O) -- +({\angle+90}:{-1.5*\a} and {-1.5*\b});
\path [name intersections = {of = cd and ellipse, by = {D} }];
\path [name intersections = {of = dk and ellipse, by = {K} }];
\node[above left,xshift=1pt,yshift=-5pt] at (D) {$D$};
\node[below right,xshift=-1pt,yshift=3pt] at (K) {$K$};
\draw (D) -- (K);

% Draw tangent at G (continuation of PC)
\draw[name path global=t2] 
  (G) -- ++ ({-\a*sin(\angle)},{\b*cos(\angle)})
  (G) -- ++ ({\a*sin(\angle)},{-\b*cos(\angle)});
% Draw tangent at D
\draw[name path global=t3] 
  (D) -- ++ ({-\a*sin(90+\angle)},{\b*cos(90+\angle)})
  (D) -- ++ ({\a*sin(90+\angle)},{-\b*cos(90+\angle)});
% Draw tangent at K (continuation of DC)
\draw[name path global=t4] 
  (K) -- ++ ({-\a*sin(90+\angle)},{\b*cos(90+\angle)})
  (K) -- ++ ({\a*sin(90+\angle)},{-\b*cos(90+\angle)});

% Draw large dashed rectangle
\draw[thick,dashed] (\a,\b) node[above right,yshift=-4pt] {$Q$} -- 
  (-\a,\b) -- (-\a,-\b) -- (\a,-\b) -- cycle;

% Get the intersections of the tangents
\path [name intersections = {of = t  and t3, by = {J} }];
\path [name intersections = {of = t2 and t3, by = {KK} }];
\path [name intersections = {of = t  and t4, by = {M} }];
\path [name intersections = {of = t2 and t4, by = {LL} }];

% Draw the parallelogram
\draw (J) node[above] {$J$} -- (KK) node[left] {$K$} -- 
  (LL) node[below] {$L$} -- (M) node[right] {$M$} -- cycle;

% Draw triangles
\draw[thick,blue] (O) -- (D) -- (P) -- cycle;
\draw[thick,red] (O) -- (Top) -- (Right) -- cycle;

% Draw perpeciculars to major axis
\draw[very thick,dashed,blue] (D) -- 
  ($(Left)!(D)!(Right)$) node[below,black] {$D'$};
\draw[very thick,dashed,blue] (P) -- 
  ($(Left)!(P)!(Right)$) node[below,black] {$P'$};

\end{tikzpicture}
\caption{Parallelograms formed by conjugate diameters}\label{f.ellipse-conj-diam-proof}
\end{center}
\end{figure}

\begin{proof}
By symmetry it suffices to prove that the areas of one pair of quadrants of the parallelograms are equal: $A_{OA'QB}=A_{PODJ}$. Since diagonals bisect a parallelogram, it suffices to prove that that the area of $\triangle A'OB$ (red) equals the area of $\triangle POD$ (blue).

Let $P=(x_p,y_p)=(a\cos t, b\sin t), D=(x_d,y_d)$ be the parametric representations of these points on the ellipse. Conjugate diameters are perpendicular so $\angle DOP$ is a right angle and
\[
D=(x_d,y_d)=(a\cos (t+\pi/2), b\sin (t+\pi/2))=(-a\sin t, b\cos t)\,.
\]
Construct $DD'=(x_d,0)$ and $PP'=(x_p,0)$ perpendicular to the major axis. The area of $\triangle POD$ can be computed as the area of the trapezoid $P'PDD'$ minus the areas of the triangles $\triangle D'DO, \triangle P'PO$. Therefore,\footnote{The \emph{length} between $O$ and $D'$ is $-x_d$.}
\begin{eqn}
\triangle POD &=& \frac{y_p+y_d}{2} (x_p+(-x_d)) - \frac{1}{2}(-x_d)y_d - \frac{1}{2}x_py_p\\
&=&\frac{1}{2}\left(x_py_d -x_dy_p\right)\\[6pt]
&=&\frac{1}{2} \left( a\cos t \cdot b \cos t - (-a)\sin t\cdot b\sin t\right)=\frac{1}{2}ab=\triangle A'OB\,.\fqed
\end{eqn}%
\end{proof}

