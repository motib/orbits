% !TeX root = orbits.tex

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Ellipses}\label{s.ellipse}

\subsection{Fundamental properties}

\begin{definition}[Ellipse]
\mbox{}
\begin{itemize}
\item Let $S$ and $H$ be two points in the plane such that $SH=2c\geq 0$ and choose $a$ such that $2a> 2c$ (Figure~\ref{f.ellipse-features1}). An \emph{ellipse} is the geometric locus of all points $P$ such that $SP+PH=2a$. If $c=0$ the geometric locus is a \emph{circle}.
\item Construct $AA'$ through $SH$, where $A,B$ are the intersections of the line with the ellipse. $AA'$ is  the \emph{major axis} of the ellipse. Let $O$ be the midpoint of $SH$. $AO,OA'$ are the \emph{semi-major axes} of the ellipse.
\item Construct the perpendicular to $AA'$ at $O$ and let $B,B'$ be its intersections with the ellipse. $BB'$ is the \emph{minor axis} of the ellipse and $BO,OB'$ are the \emph{semi-minor axes} of the ellipse.
\end{itemize}
\end{definition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[b]
\begin{center}
\begin{tikzpicture}
% Size and center of the ellipse
\def\a{3}
\def\b{2}
\def\angle{70}
\pic{ellipse={{\a}/{\b}}};
% Label distances from center to foci by c
\path (F1) -- node[below] {$c$} (O) -- node[below] {$c$} (F2);
% Select an arbitrary point on the ellipse and draw lines to the foci
\pic{point-on-ellipse={{\a}/{\b}/{\angle}}};
\draw (F1) -- (P) -- (F2);
\node[above] at (Top) {$B$};
\node[below] at (Bot) {$B'$};
\node[right] at (Right) {$A$};
\node[left] at (Left) {$A'$};
\node[below left,xshift=3pt,yshift=-2pt] at (O) {$O$};

\end{tikzpicture}
\caption{The definition of an ellipse}\label{f.ellipse-features1}
\end{center}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{theorem}(Figure~\ref{f.ellipse-features2})\label{thm.ellipses-features}
\begin{enumerate}
\item $SB=HB=a$.
\item $AO=OA'=a$.
\item $BO=OB'$. (Label $BO=OB'$ by $b$.)
\end{enumerate}
\end{theorem}

\begin{proof}
\begin{enumerate}
\item $\triangle SBO\cong\triangle HBO$ by side-angle-side  so $SB=HB$. Since $B$ is on the ellipse, $SB+HB=2a$ and $SB=HB=a$ follows. 
\item Since $A$ is on the ellipse,
\[
2a = AS+HA = (AO-c)+(AO+c)=2AO\,,
\]
so $AO=a$. $OA'=a=AO$ follows by symmetry.
\item $BO=OB'$ follows from $\triangle SBO\cong\triangle SB'O$.\hqed
\end{enumerate}
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[tb]
\begin{center}
\begin{tikzpicture}
% Ellipse
\def\a{3}
\def\b{2}
\pic{ellipse={{\a}/{\b}}};

% Label nodes
\node[above] at (Top) {$B$};
\node[below] at (Bot) {$B'$};
\node[right] at (Right) {$A$};
\node[left] at (Left) {$A'$};
\node[below] at (F1) {$S$};
\node[below] at (F2) {$H$};
\node[below left,xshift=3pt,yshift=-2pt] at (O) {$O$};

% Label segments
\path (Bot) --  
  node[left,yshift=-8pt] {$b$} (O) -- node[left] {$b$} (Top);
\path (F1) -- node[below] {$c$} (O) -- node[below] {$c$} (F2);
\draw (F1) -- node[above] {$a$} (Top) -- node[above] {$a$} (F2);

% Indicates distances along the major axis
\draw[<->] ($(O)+(0,-20pt)$) -- node[fill=white] {$a$} ($(Right)+(0,-20pt)$);
\draw[<->] ($(O)+(0,-20pt)$) -- node[fill=white] {$a$} ($(Left)+(0,-20pt)$);

\draw (O) rectangle +(6pt,6pt);
\end{tikzpicture}
\caption{The semi-major and semi-minor axes of an ellipse}
\label{f.ellipse-features2}
\end{center}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{theorem}\label{thm.ellipse-equation}
A point $P=(x,y)$ on an ellipse satisfies the equation
\begin{equation}
\frac{x^2}{a^2}+\frac{y^2}{b^2}=1\,.\label{eqn.ellipse-formula}
\end{equation}
\end{theorem}

\begin{proof}
Since $S=(-c,0)$, $H=(c,0)$ and $SP+PH=2a$,
\[
PS+PH=\sqrt{(x-(-c))^2 + y^2}+\sqrt{(x-c)^2+y^2} = 2a\,.
\]
Squaring twice results in
\begin{eqn}
(x+c)^2+y^2 &=& \left(2a - \sqrt{(x-c)^2+y^2}\right)^2\\[4pt]
4xc &=& 4a^2 -4a\sqrt{(x-c)^2+y^2}\\[4pt]
a-\frac{c}{a}x &=& \sqrt{(x-c)^2+y^2}\\[4pt]
a^2 +\frac{c^2}{a^2}x^2 &=& x^2+c^2+y^2\\[4pt]
	\frac{x^2}{a^2}+\frac{y^2}{a^2-c^2} &=& \frac{a^2-c^2}{a^2-c^2}=1\,.
\end{eqn}%

By Theorem~\ref{thm.ellipses-features} and Pythagoras's theorem, $b^2=a^2-c^2$ so
\[
\frac{x^2}{a^2}+\frac{y^2}{b^2}=1\,.\fqed
\]
\end{proof}

\subsection{A circle circumscribing an ellipse}

Consider a circle of radius $a$ with the same center as an ellipse (Figure~\ref{f.ellipse-circle}). Choose a point $X$ on the major axis and construct a perpendicular through $X=(x,0)$. Let its intersections with the ellipse and the circle be $P_e=(x,y_e)$ and $P_c=(x,y_c)$, respectively.
\begin{theorem}\label{thm.ellipse-b-over-a}
The perpendicular to the major axis through a point $P_c=(x,y_c)$ on the circle circumscribing an ellipse intersects the ellipse at $P_e=(x,y_e)=\left(x,\displaystyle\frac{b}{a}y_c\right)$.
\end{theorem}
\begin{proof} From Equation~\ref{eqn.ellipse-formula} and the formula $x^2+y^2=a^2$ for the circle,
\begin{equation}
y_e= \frac{b}{a} \,\sqrt{(a^2-x^2)}=\frac{b}{a}y_c\,.\label{eq.ye}\fqed
\end{equation}
\end{proof}

\begin{figure}[tb]
\begin{center}
\begin{tikzpicture}
\clip (-5,-.5) rectangle +(10,5.5);

\def\a{3.75}
\def\b{2.5}
\pic{semi-ellipse={{\a}/{\b}}};
\draw[name path=circle] ({\a},0) arc(0:180:{\a});

% Draw axes through O
\draw[name path=major] (Left) -- 
  node[below] {$a$} (O) -- node[below] {$a$}(Right);
\draw[name path=minor] (O) -- (Top);
\draw[<->] ($(O)+(-10pt,1pt)$) --
  node[near end,fill=white] {$a$} ($(Top)+(-10pt,-1pt)$);

% Choose arbitrary point on major-axis, raise a perpendicular
%   and label its intersections with the ellipse and the circle
\coordinate (X) at (1,0);
\path[name path=atX] (X) -- ($(X)+(0,4.5)$);
\path [name intersections = {of = atX and ellipse, by = {E1} }];
\path [name intersections = {of = atX and circle, by = {C1} }];
\draw (X) -- (C1);

% Label X and the intersections
\node[below] at (X) {$X$};
\node[above right] at (C1) {$P_c$};
\node[above right] at (E1) {$P_e$};

\draw (O) rectangle +(6pt,6pt);
\draw (X) rectangle +(6pt,6pt);

\end{tikzpicture}
\caption{A circle circumscribing an ellipse}\label{f.ellipse-circle}
\end{center}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{The latus rectum of an ellipse}

\begin{definition}\label{def.ellipse-lr}
Consider a line through a focus of an ellipse that is perpendicular the major axis. Let its intersections with the ellipse be $L_1,L_2$. Then $L=L_1L_2$ is a \emph{latus rectum} of an ellipse (Figure~\ref{f.ellipse-latus-rectum}).\footnote{Usually, lines are denoted by lower-case letters, but $L$ for the latus rectum is the standard notation.}
\end{definition}
\begin{theorem}\label{thm.ellipse-lr}
$L$, the length of the latus rectum of an ellipse, is 
$\displaystyle\frac{2b^2}{a}$.
\end{theorem}
\begin{proof}
By Equation~\ref{eq.ye} and Pythagoras's theorem,
\[
L=2L_1=2\cdot\frac{b}{a}\sqrt{a^2-c^2}=\displaystyle\frac{2b^2}{a}\,.\fqed
\]
\end{proof}

\begin{figure}[tb]
\begin{center}
\begin{tikzpicture}
\clip (-4.5,-3) rectangle +(9,7);

\def\a{3.75}
\def\b{2.5}
\pic{ellipse={{\a}/{\b}}};
\draw[name path=circle] ({\a},0) arc(0:180:{\a});
\node[below] at (F1) {$S$};
\node[below right] at (F2) {$H$};
\node[above] at (Top) {$B$};
\node[below] at (Bot) {$B'$};
\node[right] at (Right) {$A$};
\node[left] at (Left) {$A'$};

% Draw axes through O
\draw (F1) -- node[below] {$c$} (O) -- node[below,xshift=-6pt] {$c$} (F2);
\draw[name path=minor] (O) -- node[left] {$b$} (Top);
\draw (O) rectangle +(6pt,6pt);
\vertexsm{F1};
\vertexsm{F2};

% Draw latus rectum as intersections of perpendicular at H
%  with the ellipse
\path[name path=LR] ($(F2)+(0,-2.5)$) -- ($(F2)+(0,2.5)$);
\path [name intersections = {of = ellipse and LR, by = {LR1,LR2} }];
\path [name intersections = {of = circle and LR, by = {LR1c,LR2c} }];
\draw[very thick,red] (LR1) -- (LR2);

% Label endpoint of the LR
%\vertexsm{LR1};
\node[above left,xshift=2pt,yshift=6pt] at (LR1) {$L_1$};
%\vertexsm{LR2};
\node[below,yshift=-2pt] at (LR2) {$L_2$};
\draw (LR1) -- (LR1c);
\draw (F2) rectangle +(7pt,7pt);

% Length of LR
\draw[<->] ($(LR1)+(-.5,0)$) --
  node[left,xshift=2pt,yshift=8pt] {$L$} ($(LR2)+(-.5,0)$);
\end{tikzpicture}
\caption{The latus rectum of an ellipse}\label{f.ellipse-latus-rectum}
\end{center}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{The area of an ellipse}

\begin{theorem}\label{thm.ellipse-area}
The area of an ellipse is $\pi a b$.
\end{theorem}
\begin{proof}
From Equation~\ref{eq.ye}
\[
y_e = \frac{b}{a}\sqrt{a^2-x^2}\,,
\]
so the area of an ellipse is
\[
A_e = 2\int_{-a}^{a}\frac{b}{a}\sqrt{a^2-x^2}\; dx = \frac{b}{a}\cdot 2\int_{-a}^{a}\sqrt{a^2-x^2}\; dx= \frac{b}{a}A_c\,.
\]
If we can show that the area of a circle is $\pi a^2$ the theorem follows.

The proof uses polar coordinates, where $x=a\cos \theta$ and $y=a\sin \theta$. First, we derive the formula for the integral of $\sin^2 \theta$ using the double-angle identity.
\begin{eqn}
%\cos 2\theta &=& 1-2\sin^2 \theta \\[4pt]
\sin^2 \theta &=& \frac{1-\cos 2\theta}{2}\\[6pt]
\int \sin^2 \theta \;d\theta &=& \int\frac{1-\cos 2\theta}{2} \;d\theta
=\frac{\theta}{2} - \frac{\sin 2\theta}{4}  + C\,.
\end{eqn}%
\noindent{}Now we can compute the area of a circle as twice the area of a semicircle by changing from Cartesian to polar coordinates and integrating.
\begin{eqn}
A_c &=& 2\int_{-a}^{a} \sqrt{a^2-x^2} \;dx= 2\int_{-\pi}^{0} \sqrt{a^2-(a \cos \theta)^2} \;\;d(a\cos\theta)\\[4pt]
%&=& 2a^2 \int_{-\pi}^{0} \sqrt{1-\cos^2 \theta} \;\;d(\cos\theta)\\[4pt]
&=& 2\cdot a\cdot a \int_{-\pi}^{0} \sin \theta (-\sin\theta)\;d\theta
= -2a^2 \int_{-\pi}^{0} \sin^2 \theta \;d\theta\\[4pt]
&=& -2a^2 \left.\left( \frac{\theta}{2} - \frac{\sin 2\theta}{4}+C\right)\right|_{-\pi}^{0}=\pi a^2\,.\fqed
\end{eqn}%
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{The angles between a tangent and the lines to the foci}

\begin{theorem}\label{thm.tangent-angles}
Let $P$ be a point on the ellipse whose foci are $S,H$. Let $PU$ be the extension of $SP$ such that $SU=AA'=2a$. Let $RQ$ be the bisector of $\angle HPU$. Then $\angle RPS = \angle QPH$ and $RQ$ is the tangent to the ellipse at $P$ (Figure~\ref{f.tangent-angles}).
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[t]
\begin{center}
\begin{tikzpicture}

% Size and center of the ellipse
\clip (-5,-.7) rectangle +(11.5,4.7);

\def\a{4.5}
\def\b{3}

\def\angle{45}

\pic{semi-ellipse={\a}/{\b}};
\pic{point-on-ellipse={\a}/{\b}/{\angle}};
\pic{tangent={0.7*\a}/{0.7*\b}/{\angle}};

\node[below] at (Right) {$A$};
\node[below] at (Left) {$A'$};
\node[below] at (O) {$O$};
\node[below] at (F1) {$S$};
\node[below] at (F2) {$H$};

\draw (F2) -- (P) -- (F1);

% Locate another point Q on the tangent
\coordinate (Q) at ($(P)!.9!(Z)$);
\node[right,xshift=2pt,yshift=2pt] at (Q) {$Q$};
\node[right,xshift=2pt] at (R) {$R$};

% Extend line SP to U
\draw[name path=fromF1p] (F1) -- ($(F1)!1.4!(P)$) coordinate (U);
\node[right] at (U) {$U$};

% Draw HQ and QU
\draw (F2) -- 
  node[below right,xshift=6pt,yshift=6pt] {$d$} (Q) -- 
  node[right] {$d$} (U);
\draw[name path=F2U] (F2) -- (U);
\draw (F1) -- (Q);

% Draw dashed line to local W
\path [name intersections = {of = t and F2U, by = {W} }];
\node[right,xshift=1pt,yshift=-2pt] at (W) {$W$};

% Label angles
\node[below right,xshift=-1pt,yshift=-4pt] at (P) {$\alpha$};
\node[right,xshift=5pt,yshift=-1pt] at (P) {$\alpha$};
\node[left,xshift=-7pt,yshift=3pt] at (P) {$\alpha$};

% Indicate lengths of SU
\draw [<-,thick,dashed] ($(F1)+(0,3pt)$) --
   node[above,near end] {$2a$} ($(P)+(3pt,4pt)$);
\draw [->,thick,dashed] ($(P)+(12pt,7pt)$) --($(U)+(0,3pt)$);

\end{tikzpicture}
\caption{Angles at the tangent}\label{f.tangent-angles}
\end{center}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{proof} 
We prove that any point $Q\neq P$ on the bisector is not on the ellipse, so the bisector $RQ$ has only one point of intersection with the ellipse and it must be the tangent at $P$. Since $RQ$ is the angle bisector of $\angle HPU$ (the exterior angle of $\angle SPH$), $\angle QPH =\angle QPU=\alpha$, and by vertical angles $\angle QPU=\angle RPS=\alpha$.

Construct the line $HU$ to form the triangle $\triangle HPU$ which intersects $PQ$ at $W$. By construction $PH=PU$ so $\triangle HPW\cong \triangle UPW$ by side-angle-side and $UW=HW$. But $HU$ is a straight line, therefore, if $\angle HWQ=\angle UWQ$, then they are both right angles and $\triangle HWQ=\triangle UWQ$ by side-angle-side, so $UQ=HQ=d$. Suppose that $Q$ is on the ellipse so that $2a=SQ+QH=SQ+QU$. By the triangle inequality $2a=SQ+QU>SU=2a$, contradicting that $Q$ is on the ellipse.\hqed
\end{proof}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Conjugate diameters}

\begin{definition}\label{def.conjugate}
There are two equivalent definitions of conjugate diameters.
\begin{itemize}
\item Let $P$ be a point on an ellipse, $PG$ a diameter and let $t$ be the tangent to the ellipse at $P$. Diameter $DK$ is a \emph{conjugate diameter} if it is parallel to $t$ (Figure~\ref{f.ellipse-conj}).
\item Two diameters $PG$ and $DK$ are \emph{conjugate diameters} if the midpoints of chords ($D'K', D''K''$) parallel to one diameter ($DK$) lie on another diameter ($PG$).
\end{itemize}
\end{definition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[t]
\begin{center}
\begin{tikzpicture}

\clip (-3.5,-2.5) rectangle +(8,5);

\def\a{3}
\def\b{2}
\def\angle{29}

\pic{ellipse={\a}/{\b}};
\pic{point-on-ellipse={\a}/{\b}/{\angle}};
\pic{tangent={\a}/{\b}/{\angle}};

\node[above] at (Top) {$B$};
\node[below] at (Bot) {$B'$};
\node[right,xshift=-2pt] at (Right) {$A$};
\node[left] at (Left) {$A'$};
\node[below left,xshift=3pt,yshift=-2pt] at (O) {$O$};

% Diameter from P through O
\draw[name path=pc] (P) -- ($(P)!2!(O)$) coordinate (G);
\node[left,yshift=-2pt] at (G) {$G$};

% Conjugate diameters from D through O
\draw[name path=cd] (O) -- +({90+\angle}:{\a} and {\b});
\path[name path=dk] (O) -- +({-90+\angle}:{\a} and {\b});
\path [name intersections = {of = cd and ellipse, by = {D} }];
\path [name intersections = {of = dk and ellipse, by = {K} }];
\node[above left] at (D) {$D$};
\node[below right] at (K) {$K$};
\draw (D) -- (K);

% Draw parallels to the tangent
\coordinate (PP) at ($(O)!.35!(G)$);
\path[name path=pp1] (PP) -- ++ ({-\a*3*sin(\angle)},{\b*3*cos(\angle)});
\path [name intersections = {of = pp1 and ellipse, by = {DP} }];
\path[name path=pp2] (PP) -- ++ ({\a*3*sin(\angle)},{-\b*3*cos(\angle)});
\path [name intersections = {of = pp2 and ellipse, by = {KP} }];
\draw[thick,dashed,name path=center1] (DP) node[above] {$D'$} -- 
  (KP) node[below right] {$K'$};

\coordinate (PPP) at ($(O)!.6!(P)$);
\path[name path=ppp1] (PPP) -- ++ ({-\a*3*sin(\angle)},{\b*3*cos(\angle)});
\path [name intersections = {of = ppp1 and ellipse, by = {DPP} }];
\path[name path=ppp2] (PPP) -- ++ ({\a*3*sin(\angle)},{-\b*3*cos(\angle)});
\path [name intersections = {of = ppp2 and ellipse, by = {KPP} }];
\draw[thick,dashed,name path=center2] (DPP) node[above] {$D''$} --
  (KPP) node[below right] {$K''$};

\path [name intersections = {of = center1 and pc, by = {C1} }];
\path [name intersections = {of = center2 and pc, by = {C2} }];
\vertexsmcolor{O}{red};
\vertexsmcolor{C1}{red};
\vertexsmcolor{C2}{red};

\end{tikzpicture}
\caption{Conjugate diameters}\label{f.ellipse-conj}
\end{center}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{theorem}\label{thm.ratios}
Let $P=(x,y)$ be a point on an ellipse (not on the major axis $AA'$) and construct a perpendicular $PV$ from $P$ to the major axis (Figure~\ref{f.ellipse-ratios}). Then
\[
\frac{A'V\cdot AV}{PV^2} = \frac{a^2}{b^2}\,.
\]
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{proof}
By Equation~\ref{eq.ye},
\begin{eqn}
y^2&=&b^2\cdot \left(1-\frac{x^2}{a^2}\right)=\frac{b^2(a^2-x^2)}{a^2}\\
\frac{A'V\cdot AV}{PV^2}&=&\frac{(a+x)(a-x)}{y^2}=\frac{a^2(a^2-x^2)}{b^2(a^2-x^2)}= \frac{a^2}{b^2}\,.\fqed
\end{eqn}%
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[b]
\begin{center}
\begin{tikzpicture}

% Size and center of the ellipse
\def\a{3.75}
\def\b{2.5}
\coordinate (O) at (0,0);
\node[below] at (O) {$O$};

% Draw an ellipse with center C
\draw[name path=ellipse] (\a,0) 
  arc[start angle=0,end angle=180, x radius=\a,y radius=\b];

% Locate the foci
\coordinate (F1) at ({-sqrt(\a*\a-\b*\b)},0);
\coordinate (F2) at ({+sqrt(\a*\a-\b*\b)},0);

% Draw axes whose center is C
\coordinate (L) at +(180:{\a} and {\b});
\coordinate (R) at +(0:{\a} and {\b});
\node[below right] at (R) {$A$};
\node[below left] at (L) {$A'$};
\coordinate (Top) at +(90:{\a} and {\b});
\draw[name path=major] (L) -- (R);
\draw[name path=minor] (O) -- (Top);

% Select an arbitrary point P on the ellipse and draw lines to the major axes
\path[name path=fromF1p] (F1) -- +(30:6);
\path [name intersections = {of = ellipse and fromF1p, by = {P} }];
\node[above right,yshift=-4pt] at (P) {$P=(x,y)$};
\path[name path=pv] (P) -- +(0,-\b);
\path [name intersections = {of = major and pv, by = {V} }];
\draw (P) -- node[left] {$y$} (V) node[below] {$V$};

% Draw length arrows
\draw[<->] ($(L)+(0,-24pt)$) -- 
  node[fill=white] {$a\!+\!x$} ($(V)+(0,-24pt)$);
\draw[<->] ($(V)+(0,-24pt)$) -- 
  node[fill=white] {$a\!-\!x$} ($(R)+(0,-24pt)$);

% Dots at vertices
%\vertexsm{P};
%\vertexsm{V};

\end{tikzpicture}
\caption{Ratios on conjugate diameters}\label{f.ellipse-ratios}
\end{center}
\end{figure}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[t]
\begin{center}
\begin{tikzpicture}

\clip (-3.8,-2.5) rectangle +(7.5,5.4);

% Size and center of the ellipse
\def\a{3}
\def\b{2}
\def\angle{24}

\pic{ellipse={\a}/{\b}};
\node[below left,xshift=2pt] at (O) {$O$};
\begin{scope}[rotate=24]
\draw[name path=ellipse1,thick,dashed] (O) 
  ellipse[x radius={\a},y radius= {\b}];
\path ({-\a},0) coordinate (G) node[left] {$G$} -- 
  ({\a},0) coordinate (P) node[right] {$P$};
\draw (0,{-\b}) coordinate (K) node[below,yshift=-2pt] {$K$} -- 
  (0,{\b}) coordinate (D) node[above] {$D$};

% Select an arbitrary point Q on the ellipse and draw a line to the Sun
\path [name path=oq] (O) -- +(40:7);
\path [name intersections = {of = ellipse1 and oq, by = {Q} }];
\node[above] at (Q) {$Q$};

% Draw QV
\draw[green!80!black,thick] (Q) -- 
  ($(G)!(Q)!(P)$) coordinate (V) node[black,below] {$V$};
\draw[red,thick] (G) -- (V);
\draw[blue,thick] (V) -- (P);

\vertexsm{G};
\vertexsm{P};
\vertexsm{D};
\vertexsm{Q};
\vertexsm{K};
\end{scope}
\end{tikzpicture}
\caption{Ratios on conjugate diameters}\label{f.conj-ratios}
\end{center}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{theorem}\label{thm.conj-diag}
Let $PG,DK$ be conjugate diameters of an ellipse and let $Q$ be a point on the ellipse (Figure~\ref{f.conj-ratios}). Constrct the perpendicular $QV$ from $Q$ to the major axis, then
\[
PV = \frac{QV^2\cdot CP^2}{GV \cdot CD^2}\,.
\]
\end{theorem}

\begin{proof}
Figure~\ref{f.conj-ratios} shows a dashed ellipse which is the original ellipse rotated about the same center $O$, so that $OP$ is the semi-major axis and $OD$ is the semi-minor axis. By Theorem~\ref{thm.ratios},
\[
\frac{GV\cdot PV}{QV^2}=\frac{a'^2}{b'^2}\,,
\]
where $a',b'$ are the lengths of the semi-major and semi-minor axes of the rotated ellipse. By construction $a'=OP$ and $b'=OD$ so
\begin{eqn}
\frac{GV\cdot PV}{QV^2} &=& \frac{CP^2}{OD^2}\\
PV &=& \frac{QV^2\cdot CP^2}{GV \cdot OD^2}\,.\fqed
\end{eqn}%
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{The parametric representation of an ellipse}

Figure~\ref{f.parametric} shows an ellipse and two circles: one whose radius is the length of the semi-major axis (dotted red) and one whose radius is the semi-minor axis (dashed blue). The figure shows the \emph{parametric representation} of a point $P=(x,y)$ on the ellipse:
\[
(x,y)= (a\cos t,\, y = b \sin t)\,.
\]
The parameter $t$ is \emph{not} the angle of $P$ relative to the positive $x$-axis. Construct the perpendicular through $P$ to the minor axis and let $P_I$ be its intersection with the inner circle so that $CP_I$ defines an angle $t$.  Extend $C_I$ until it intersects the outer circle at $P_O$. The parametric representation of $P$ is computed from the lengths of the axes and trigonometry functions of $t$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[t]
\begin{center}
\begin{tikzpicture}
\clip (-3.1,-3.3) rectangle +(6.2,6.6);
% Size and center of the ellipse
\def\a{3}
\def\b{2}
\coordinate (C) at (0,0);
\node[below left,xshift=2pt] at (C) {$O$};

% Draw an ellipse and the inner and outer circles
\draw[name path=ellipse] (C) ellipse[x radius=\a,y radius= \b];
\draw[very thick,dotted,red,name path=outer] (C) circle[radius=\a];
\draw[thick,dashed,blue,name path=inner] (C) circle[radius=\b];

% Locate P on the ellipse
\path[name path=toP] (C) -- +(30:4);
\path [name intersections = {of = ellipse and toP, by = {P} }];

% Label the angle of CP
\node[above right,xshift=8pt,yshift=-2pt] at (C) {$t$};

% Draw major and minor axes
\draw[name path=yplus] (C) -- +(0,\a);
\draw (C) -- +(0,-\a);
\draw[name path=xplus] (C) -- +(\a,0);
\draw (C) -- +(-\a,0);

% Find intersection PI of line from center to P and the inner circle
\node[above] at (P) {$P$};
\vertexsm{P};
\path[name path=horiz] (P) -- +(-\a,0);
\path [name intersections = {of = inner and horiz, by = {PI} }];

% Extend ray C->PI to outer circle and label intersection PO
\draw[name path=ray] (C) -- ($(C) !1.7! (PI)$) coordinate (PO);

% Project PO on x axis
\path[thick,name path=horizPO] (PO) -- +(0,-\a);
\path [name intersections = {of = xplus and horizPO, by = {xint} }];
\draw (PO) -- (xint);
\draw[<->,style={shorten <= 2pt}] ($(C)+(0,-5pt)$) --
  node[below,xshift=-4pt] {$a\cos t$} ($(xint)+(0,-5pt)$);

% Project PI on y axis
\path [name intersections = {of = yplus and horiz, by = {yint} }];
\draw[<->] ($(C)+(-5pt,0)$) -- 
  node[left,xshift=1pt] {$b\sin t$} ($(yint)+(-5pt,0)$);
\draw (P) -- (yint);

% Draw blue and red lines from C to PI and PO
\draw[thick,blue] (C) -- (PI);
\draw[thick,red] (PI) -- (PO);

% Dots at vertices
\vertexsmcolor{PI}{blue};
\vertexsmcolor{PO}{red};
\node[below,yshift=-4pt] at (PI) {$P_I$};
\node[above] at (PO) {$P_O$};
%\vertexsm{C};
%\vertexsm{P};

\end{tikzpicture}
\caption{Parametric representation of an ellipse}\label{f.parametric}
\end{center}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55

\subsection{Areas of parallelograms}

\begin{theorem}\label{thm.conj-diam-para}
The areas of the parallelograms formed by tangents to the intersections of and pair of conjugate diameters with the ellipse are equal (Figure~\ref{f.ellipse-conj-diam-proof}).
\end{theorem}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{figure}[b]
\begin{center}
\begin{tikzpicture}
\clip (-5,-3.3) rectangle +(10,6.6);

% Size and center of the ellipse
\def\a{3}
\def\b{2}
\def\angle{35}

\pic{ellipse={\a}/{\b}};
\pic{point-on-ellipse={\a}/{\b}/{\angle}};
\pic{tangent={\a}/{\b}/{\angle}};

% Conjugate diameter from P through C
\draw[name path=pc] (P) -- ($(P)!2!(O)$) coordinate (G);

\node[above,yshift=-1pt] at (Top) {$B$};
\node[below,yshift=1pt] at (Bot) {$B'$};
\node[right,xshift=1pt] at (Right) {$A$};
\node[left] at (Left) {$A'$};
\node[below left,xshift=3pt,yshift=-2pt] at (O) {$O$};


% Conjugate diameters from D through C
\path[name path=cd] (O) -- +({\angle+90}:{1.5*\a} and {1.5*\b});
\path[name path=dk] (O) -- +({\angle+90}:{-1.5*\a} and {-1.5*\b});
\path [name intersections = {of = cd and ellipse, by = {D} }];
\path [name intersections = {of = dk and ellipse, by = {K} }];
\node[above left,xshift=1pt,yshift=-5pt] at (D) {$D$};
\draw (D) -- (K);

% Draw tangent at G (continuation of PC)
\draw[name path global=t2] 
  (G) -- ++ ({-\a*sin(\angle)},{\b*cos(\angle)})
  (G) -- ++ ({\a*sin(\angle)},{-\b*cos(\angle)});
% Draw tangent at D
\draw[name path global=t3] 
  (D) -- ++ ({-\a*sin(90+\angle)},{\b*cos(90+\angle)})
  (D) -- ++ ({\a*sin(90+\angle)},{-\b*cos(90+\angle)});
% Draw tangent at K (continuation of DC)
\draw[name path global=t4] 
  (K) -- ++ ({-\a*sin(90+\angle)},{\b*cos(90+\angle)})
  (K) -- ++ ({\a*sin(90+\angle)},{-\b*cos(90+\angle)});

% Draw large dashed rectangle
\draw[thick,dashed] (\a,\b) -- (-\a,\b) -- (-\a,-\b) -- (\a,-\b) -- cycle;

% Get the intersections of the tangents
\path [name intersections = {of = t  and t3, by = {J} }];
\path [name intersections = {of = t2 and t3, by = {KK} }];
\path [name intersections = {of = t  and t4, by = {M} }];
\path [name intersections = {of = t2 and t4, by = {LL} }];

% Draw the parallelogram
\draw (J) node[above] {$J$} -- (KK) node[left] {$K$} -- 
  (LL) node[below] {$L$} -- (M) node[right] {$M$} -- cycle;

% Draw triangles
\draw[thick,blue] (O) -- (D) -- (P) -- cycle;
\draw[thick,red] (O) -- (Top) -- (Right) -- cycle;

% Draw perpeciculars to major axis
\draw[very thick,dashed,blue] (D) -- 
  ($(Left)!(D)!(Right)$) node[below] {$D'$};
\draw[very thick,dashed,blue] (P) -- 
  ($(Left)!(P)!(Right)$) node[below] {$P'$};

\end{tikzpicture}
\caption{Parallelograms formed by conjugate diameters}\label{f.ellipse-conj-diam-proof}
\end{center}
\end{figure}

\begin{proof}
We show that the area of the parallelogram $JKLM$ is equal to the area of the parallelogram formed by tangents to the major and minor axes (dashed). By symmetry it suffices to prove that the areas of one of the quadrants of those parallelograms are equal: $A_{ACBC'}=A_{PCDJ}$. Since the diagonals bisect a parallelogram, it suffices to prove that that the area of $\triangle ABC$ (red) equals the area of $\triangle PCD$ (blue).

Let $P=(x_p,y_p)=(a\cos t, b\sin t), D=(x_d,y_d)$ be the parametric representations of the points on the ellipse. Conjugate diameters are perpendicular so $\angle DCP$ is a right angle and
\[
D=(x_d,y_d)=(a\cos (t+\pi/2), b\sin (t+\pi/2))=(-a\sin t, b\cos t)\,.
\]
Construct $DD'=(x_d,0)$ and $PP'=(x_p,0)$ perpendicular to the major axis. The area of $\triangle PCD$ can be computed as the area of the trapezoid $P'PDD'$ minus the areas of the triangles $\triangle D'DC, \triangle P'PC$. Therefore,
\begin{eqn}
\triangle PCD &=& \frac{y_p+y_d}{2} (x_p-x_d) - \frac{1}{2}x_dy_d - \frac{1}{2}x_py_p=\frac{1}{2}\left(x_py_d -x_dy_p\right)\\[6pt]
&=&\frac{1}{2} \left( a\cos t \cdot b \cos t - (-a)\sin t\cdot b\sin t\right)=\frac{1}{2}ab=\triangle ABC\,.\fqed
\end{eqn}%
\end{proof}

